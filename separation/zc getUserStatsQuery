getUserStatsQuery({ mediaType = 'ANIME', layout = 'card', useViewer = false } = {}) {
  const typeKey = mediaType.toLowerCase(); // 'anime' or 'manga'

  const statFields = {
    compact: `
      count
      meanScore
    `,
    card: `
      count
      meanScore
      standardDeviation
    `,
    full: `
      count
      meanScore
      standardDeviation
      episodesWatched
      minutesWatched
      chaptersRead
      volumesRead
    `
  };

  const selectedFields = statFields[layout] || statFields.card;

  const viewerPrefix = useViewer ? 'Viewer' : `User(name: $username)`;

  return `
    query ($username: String) {
      ${viewerPrefix} {
        id
        name
        avatar {
          large
          medium
        }
        statistics {
          ${typeKey} {
            ${selectedFields}
          }
        }
      }
    }
  `;
}